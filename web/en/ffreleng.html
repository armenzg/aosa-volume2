<!-- vim: set ts=2 sw=2 tw=70: -->
<html>
  <head>
    <style type="text/css">
      div.inline { float:left; }
    </style>
    <meta name="provenance" content="$Id$" />
    <link rel="stylesheet" href="aosa.css" type="text/css" />
    <title>The Architecture of Open Source Applications, Volume 2: Firefox Release Engineering</title>
  </head>
  <body>

    <div class="header">
      <table>
	<tr>
	  <td>
	    <a href="index.html"><img src="../images/titlebar.jpg" alt="The Architecture of Open Source Applications, Volume 2" /></a>
	  </td>
	  <td>
	    <strong><em>The Architecture of Open Source Applications, Volume 2</em></strong>
	    <br/>
	    <strong>Amy Brown and Greg Wilson (eds.)</strong>
	  </td>
	</tr>
      </table>
      <h1 class="chaptitle">Firefox Release Engineering</h1>
      <h1 class="chapterauthor">
        <a href="intro.html#atlee-chris">Chris AtLee</a>, 
        <a href="intro.html#blakk-lukas">Lukas Blakk</a>,
        <a href="intro.html#oduinn-john">John O'Duinn</a>, 
        <a href="intro.html#zambrano-gasparnian-armen">Armen Zambrano Gasparnian</a>
      </h1>
    </div>

<!-- FORMATTING -->
<!-- Sections go into divs
<div class="sect"></div>
-->

<!-- Headers are level 2 with the following format:
<h2>{Chapter#}.{Section#} {Section Title}</h2>
-->

<!-- Then mostly normal markup for paragraphs
<p>Lorem Ipsum...</p>
-->

<!-- Example of how to incorporate a diagram
<div class="figure" id="fig.ffreleng.arch">
  <img src="../images/ffreleng/diagram.png" alt="[Image Title]" />
  <p>Figure&nbsp;{Chapter#}.{Section#}: {Image Title}</p>

</div>
-->
    <!-- Introduction does not need a section div -->
    <p>
    The Mozilla Release Engineering team has made a lot of advances
    recently in how our release automation works and it's getting to
    be quite close to pushing a button, with minimal human
    interventions, eliminating many of the headaches and do-overs
    often resulting with the old ways. In this chapter we will explore
    and explain the infrastructure decisions as well as scripts that
    comprise the complete, and current, Firefox rapid release system.
    </p>

    <p>
    You'll see the system from the perspective of a release-worthy
    changeset in the mozilla-beta repository as it is turned into a
    release candidate, and then a public release.  Accompanied by
    diagrams, we'll start with builds &amp; signing, then on to how we
    generate update snippets for every supported version and OS out in
    the wild, finally stopping for loads of verification automation as
    well as manual QA before being pushed out to a network of mirrors
    for availability to our users.
    </p>

    <p>
    We'll look at some of the newer decisions that have been made to improve
    this process like our sanity-checking script that helps eliminate much
    of what used to be vulnerable to human error, our automated signing
    script, our integration of mobile releases into the desktop release
    stream, and the land of patcher/AUS where updates are created and served
    to our over 400 million users across multiple versions of the software.
    </p>

    <p>
    We'll show how the new rapid release process metrics and talk
    about how we've generalized much of the configuration we use to be
    able to maintain only one Mercurial repository for all our release
    code.
    </p>

    <p>
    Come along for a wild ride and follow a Mozilla Firefox release
    from the moment the release coordinator gives the official "Go" to
    when it's available for download (or update) to your computer or
    mobile device.
    </p>

    <!-- Rough outline of sections -->
    <div class="sect">
      <h2>6.1 "Go to Build"</h2>
      <div class="figure" id="fig.ffreleng.go_to_build" class="inline">
        <img src="../images/ffreleng/go_to_build.png" alt="Getting from code to a 'Go' to build" />
        <p>Figure&nbsp;6.1: Getting from code to a 'Go' to build</p>
      </div>
      <p>
      Throughout the beta cycle for Firefox, we are doing periodic
      releases from our <a
        href="http://hg.mozilla.org/releases/mozilla-beta/">mozilla-beta</a>
      repository. Each one of these beta releases goes through the
      full release automation and is treated almost identically to our
      regular final releases.
      </p>

      <p>
      For each beta release, we're looking to see if bugs or crashes
      we've fixed internally fix the problems for users.
      </p>

      go/no-go decision
      </p>
    </div>

    <div class="sect">
      <h2>6.2 Tagging, Building, and Source Tarballs</h2>
      <div class="figure" id="fig.ffreleng.tagging">
        <img src="../images/ffreleng/tagging.png" alt="Automated tagging" />
        <p>Figure&nbsp;6.2: Automated tagging</p>
      </div>
        <p>
        When we start automation we tag Firefox & Fennec in parallel.  Write about hgtool here - what it does and why we wrote it? How we handle buildN using RELBRANCH?
        </p>
    </div>

    <div class="sect">
      <h2>6.3 Repacks and L10N</h2>
      <div class="figure" id="fig.ffreleng.repacks_l10n">
        <img src="../images/ffreleng/repacks_l10n.png" alt="Repacking Firefox for each localization" />
        <p>Figure&nbsp;6.3: Repacking Firefox for each localization</p>
      </div>
        <p>Explain the process here of how we currently get our locale changesets, why they are in two different formats, and how the repacking code works.</p>
    </div>

    <div class="sect">
      <h2>6.4 Signing</h2>
      <div class="figure" id="fig.ffreleng.signing">
        <img src="../images/ffreleng/signing.png" alt="Signing Firefox installers" />
        <p>Figure&nbsp;6.3: Signing of Firefox installers, partially automated</p>
      </div>
      <p></p>
    </div>

    <div class="sect">
      <h2>6.5 Updates</h2>
      <p></p>
    </div>
    
    <div class="sect">
      <h2>6.6 Pushing Internal & QA</h2>
      <p></p>
    </div>

    <div class="sect">
      <h2>6.7 AUS and Pushing Public</h2>
      <p></p>
    </div>

    <div class="sect">
      <h2>6.8 Working in the open</h2>
      <p>
      At Mozilla we strive to do everything in the open. All of
      Release Engineering's code and notes are public, available to
      see. Here are some links for further reading:
      </p>
      <ul>
        <li><a href="http://hg.mozilla.org/build">build group's
        repositories</a>. In particular, the buildbotcustom,
        buildbot-configs, and tools repositories are used heavily for
        releases.</li>
        <li><a
          href="https://wiki.mozilla.org/Releases/Firefox_7.0b4/BuildNotes">Firefox
          7.0 Beta 4 Build Notes</a>. In addition to code, we document
        every aspect of a release. Here's an example from our 7.0b4
        release.</li>
      </ul>
    </div>

    <div class="footer">
    </div>
  </body>
</html>
